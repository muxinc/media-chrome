---
import { Markdown } from '@astropub/md';
import MainLayout from './MainLayout.astro';
import cem from '../../../dist/custom-elements.json';

const { frontmatter, headings, url } = Astro.props as Props;
const componentName = url.split('/').pop();

const cls = cem.modules
  .find(mod => mod.path === `dist/${componentName}.js`)
  ?.declarations
  .find(({ kind }) => kind === 'class');

cls?.slots && headings.push({ depth: 2, slug: 'slots', text: 'Slots' });
cls?.attributes && headings.push({ depth: 2, slug: 'attributes', text: 'Attributes' });
cls?.cssProperties && headings.push({ depth: 2, slug: 'css-custom-properties', text: 'CSS Custom Properties' });

---
<MainLayout frontmatter={frontmatter} headings={headings}>
  <slot />

  {cls?.slots &&
    <Markdown of={`## Slots`} />
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        {
          cls
            .slots
            .map(({ name, description }) => {
              return <tr>
                  <td class="nowrap"><code>{name}</code></td>
                  <td>{description}</td>
                </tr>
            })
        }
      </tbody>
    </table>}

  {cls?.attributes &&
    <Markdown of={`## Attributes`} />
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        {
          cls
            .attributes
            .map(({ name, description, type }) => {
              return <tr>
                  <td class="nowrap"><code>{name}</code></td>
                  <td class="nowrap">{type?.text && <code>{type?.text}</code>}</td>
                  <td>{description}</td>
                </tr>
            })
        }
      </tbody>
    </table>}

  {cls?.cssProperties &&
    <Markdown of={`## CSS Custom Properties`} />
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Default</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        {
          cls
            .cssProperties
            .map((cssProp) => {
              return <tr>
                  <td class="nowrap"><code>{cssProp.name}</code></td>
                  <td style="max-width: 20rem;">{cssProp.default && <code>{cssProp.default}</code>}</td>
                  <td>{cssProp.description}</td>
                </tr>
            })
        }
      </tbody>
    </table>}

</MainLayout>
